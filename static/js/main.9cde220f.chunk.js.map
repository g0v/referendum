{"version":3,"sources":["App.js","serviceWorker.js","index.js"],"names":["App","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","state","results","ready","onDownload","html2canvas","document","getElementById","then","canvas","link","createElement","download","href","toDataURL","click","onClick","setState","onComplete","result","data","model","Survey","title","showQuestionNumbers","showCompletedPage","goNextPageAutomatic","pagePrevText","pageNextText","completeText","pages","questions","type","name","choices","visibleIf","idx","undefined","q1a","q1b","q2","q3","q4","q5","q6","q7","_this2","_this$state","react_default","a","className","id","_","map","question","key","concat","renderAnswer","target","survey_react","Component","Boolean","window","location","hostname","match","ReactDOM","render","src_App_0","navigator","serviceWorker","registration","unregister"],"mappings":"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","file":"static/js/main.9cde220f.chunk.js","sourcesContent":["import _ from 'lodash';\nimport React, { Component } from 'react';\nimport html2canvas from 'html2canvas';\nimport * as Survey from 'survey-react';\nimport \"survey-react/survey.css\";\nimport './App.css';\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    const data = {\n      title: \"2018 全國性公民投票案\",\n      showQuestionNumbers: 'off',\n      showCompletedPage: false,\n      goNextPageAutomatic: true,\n      pagePrevText: '前一問題',\n      pageNextText: '沒意見',\n      completeText: '請給我建議',\n      pages: [{\n        title: '問題 1',\n        questions: [{\n          type: \"radiogroup\",\n          name: \"q1a\",\n          title: \"你是否支持 火力發電？\",\n          choices: [\"支持\", \"反對\"]\n        }],\n      }, {\n        title: '問題 1.1',\n        questions: [{\n          visibleIf: \"{q1a}='反對'\",\n          type: \"radiogroup\",\n          name: \"q1b\",\n          title: \"你是否支持 以「平均每年至少降低 1%」之方式逐年降低火力發電量？\",\n          choices: [\"支持\", \"反對\"]\n        }],\n      }, {\n        title: '問題 2',\n        questions: [{\n          type: \"radiogroup\",\n          name: \"q2\",\n          title: \"你是否支持 燃煤發電？\",\n          choices: [\"支持\", \"反對\"]\n        }]\n      }, {\n        title: '問題 3',\n        questions: [{\n          type: \"radiogroup\",\n          name: \"q3\",\n          title: \"你是否支持 開放核災食品進口？\",\n          choices: [\"支持\", \"反對\"]\n        }]\n      }, {\n        title: '問題 4',\n        questions: [{\n          type: \"radiogroup\",\n          name: \"q4\",\n          title: \"你是否支持 婚姻平權？\",\n          choices: [\"支持\", \"反對\"]\n        }]\n      }, {\n        title: '問題 5',\n        questions: [{\n          type: \"radiogroup\",\n          name: \"q5\",\n          title: \"你是否支持 在國民教育階段應實施性別平等教育？\",\n          choices: [\"支持\", \"反對\"]\n        }]\n      }, {\n        title: '問題 6',\n        questions: [{\n          type: \"radiogroup\",\n          name: \"q6\",\n          title: \"你是否支持 使用『台灣』參加奧運？\",\n          choices: [\"支持\", \"反對\"]\n        }]\n      }, {\n        title: '問題 7',\n        questions: [{\n          type: \"radiogroup\",\n          name: \"q7\",\n          title: \"你是否支持 核能發電？\",\n          choices: [\"支持\", \"反對\"]\n        }]\n      }]\n    };\n\n    this.model = new Survey.Model(data);\n  }\n\n  state = {\n    results: null,\n    ready: false,\n  }\n\n  onDownload = () => {\n    html2canvas(document.getElementById('results')).then((canvas) => {\n      // window.location.href = canvas.toDataURL('image/png').replace(\"image/png\", \"image/octet-stream\");\n      const link = document.createElement('a');\n      link.download = 'g0v.png';\n      link.href = canvas.toDataURL('image/jpeg');\n      link.click();\n    });\n  }\n\n  onClick = () => this.setState({ ready: true });\n\n  onComplete = result => this.setState({ results: result.data });\n\n  renderAnswer(idx, results) {\n    if (idx === 0) {\n      if (results.q1a === undefined || results.q1b === undefined) {\n        return '不投票';\n      }\n      if (results.q1a === '支持') return '不同意';\n      else if (results.q1b === '不支持') return '不同意';\n      return '同意';\n    } else if (idx === 1) {\n      if (results.q2 === undefined) return '不投票';\n      if (results.q2 === '支持') return '不同意'\n      return '同意'\n    } else if (idx === 2) {\n      if (results.q3 === undefined) return '不投票';\n      if (results.q3 === '支持') return '不同意'\n      return '同意'\n    } else if (idx === 3) {\n      if (results.q4 === undefined) return '不投票';\n      if (results.q4 === '支持') return '不同意'\n      return '同意'\n    } else if (idx === 4) {\n      if (results.q5 === undefined) return '不投票';\n      if (results.q5 === '支持') return '不同意'\n      return '同意'\n    } else if (idx === 5) {\n      if (results.q4 === undefined) return '不投票';\n      if (results.q4 === '支持') return '不同意'\n      return '同意'\n    } else if (idx === 6) {\n      if (results.q6 === undefined) return '不投票';\n      if (results.q6 === '支持') return '同意'\n      return '不同意'\n    } else if (idx === 7) {\n      if (results.q4 === undefined) return '不投票';\n      if (results.q4 === '支持') return '同意'\n      return '不同意'\n    } else if (idx === 8) {\n      if (results.q5 === undefined) return '不投票';\n      if (results.q5 === '支持') return '同意'\n      return '不同意'\n    } else if (idx === 9) {\n      if (results.q7 === undefined) return '不投票';\n      if (results.q7 === '支持') return '同意'\n      return '不同意'\n    }\n\n    return '';\n  }\n\n  render() {\n    const { model } = this;\n    const { results, ready } = this.state;\n\n    if (!ready) {\n      return (\n        <div className=\"enter\">\n          <h3><span>2018 全國性公民投票案</span></h3>\n          <div className=\"main\">\n            <span>透過工具回答 7 個問題，<br />將產生適合你的公投小抄</span>\n            <button className=\"button\" onClick={this.onClick}>開始使用</button>\n          </div>\n          <div className=\"footer\">此工具由 yutin 及 g0v 社群協作完成，程式授權採 MIT License，有任何錯誤可至 https://github.com/g0v/referendum 提出修正。</div>\n        </div>\n      );\n    }\n\n    if (results) {\n      return (\n        <div className=\"results\" id=\"results\">\n          <h3><span>2018 全國性公民投票案</span></h3>\n          <button className=\"button\" onClick={this.onDownload}>下載我的小抄</button>\n          {_.map([\n            '第七案：你是否同意以「平均每年至少降低1%」之方式逐年降低火力發電廠發電量？',\n            '第八案：您是否同意確立「停止新建、擴建任何燃煤發電廠或發電機組（包括深澳電廠擴建）」之能源政策？',\n            '第九案：你是否同意政府維持禁止開放日本福島311核災相關地區，包括福島與周遭4縣市（茨城、櫪木、群馬、千葉）等地區農產品及食品進口？',\n            '第十案：你是否同意民法婚姻規定應限定在一男一女的結合？',\n            '第十一案：你是否同意在國民教育階段內（國中及國小），教育部及各級學校不應對學生實施性別平等教育法施行細則所定之同志教育？',\n            '第十二案：你是否同意以民法婚姻規定以外之其他形式來保障同性別二人經營永久共同生活的權益？',\n            '第十三案：你是否同意，以「台灣」（Taiwan）為全名申請參加所有國際運動賽事及2020年東京奧運？',\n            '第十四案：您是否同意，以民法婚姻章保障同性別二人建立婚姻關係？',\n            '第十五案：您是否同意，以「性別平等教育法」明定在國民教育各階段內實施性別平等教育，且內容應涵蓋情感教育、性教育、同志教育等課程？',\n            '第十六案：是否同意：廢除電業法第95條第1項，即廢除「核能發電設備應於中華民國一百十四年以前，全部停止運轉」之條文？',\n          ], (question, idx) => (\n            <div className=\"items\" key={`q${idx}`}>\n              <div className=\"question\">{question}</div>\n              <div className=\"answer\">{this.renderAnswer(idx, results)}</div>\n            </div>\n          ))}\n          <div>\n            <a href=\"https://hackmd.io/c/Hk7SAIH6Q/\" target=\"hackmd\">\n              更多說明請參考公投公報電子書\n            </a>\n          </div>\n        </div>\n      );\n    }\n\n    return (\n      <Survey.Survey\n        model={model}\n        onComplete={this.onComplete}\n      />\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}